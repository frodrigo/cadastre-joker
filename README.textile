h1. cadastre-joker

This porject is base on WhooTS to server French Cadastre WMS as TMS.

It just redirect HTTP request after redesign the URL query part.

h2. Joker

Le WMS du cadastre n'est disponible que pour une commune à la foise. Cadastre-joker trouve la bonne commune à utiliser en fonction de la potion de la tuile consulté.

Les polygones de communes proviennent de : https://www.data.gouv.fr/fr/datasets/decoupage-administratif-communal-francais-issu-d-openstreetmap/

```
unzip communes-20200101-shp.zip
shp2pgsql communes-20200101.shp | psql

psql -c "
create table communes as select insee, nom, st_setsrid(geom, 4326) as geom from "communes-20200101";
create index communes_idx on communes using gist(geom);
"
```

h2. Install

bundle install

h2. Run

bundle exec ruby config.ru

h2. Usage

tms\[20\]:http://localhost:4567/{insee}/{style}/{z}/{x}/{y}.png

* {insee}: à remplacer par le code insee de la commune ou par "*" pour le mode joker automatique (et double joker "**" pour les tuiles complémentaires à cheval sur plusieurs communes)
* {style}: "tout", "semi", "transp" ou un style personalisé du cadastre
